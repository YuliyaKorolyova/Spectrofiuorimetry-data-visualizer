import plotly.graph_objects as go

import pandas as pd

import numpy as np

prep_data = {'215': [-3495.284, -636.955, -1029.765, -386.103, -283.663, -96.283, -269.89, -107.239, -143.89, -45.854, -210.82, -25.065, -126.569, -121.049, -55.517, -36.902, -30.29, -6.844, 22.366, -19.408, -32.476, 5.667, -21.918, -7.228, -17.966, 5.24, 20.222, -13.487, -27.455, -29.405],
        '225': [-2529.424, -1952.132, 215.524, -329.279, -78.128, -209.399, -164.522, -26.894, 13.562, -34.855, -117.955, -27.013, -75.915, -22.712, -49.961, -49.688, 8.942, 3.981, -51.849, -83.71, -18.053, -41.973, -10.383, -28.887, -47.578, 47.67, -15.583, -41.697, 0.251, -60.183],
        '235': [-4908.763, -1825.354, 5843.261, 26525.309, -121.553, -278.364, -74.04, -219.568, -102.849, -122.873, -118.12, -30.961, -86.379, -38.298, -30.321, 10.675, -10.598, -8.054, -21.683, -43.303, -19.942, 15.561, 7.37, -20.565, -30.866, 59.219, 1281.144, 1289.002, 2.695, -6.03],
        '245': [-1824.91, -1900.485, -179.94, 30531.849, 57231.446, -170.084, -130.442, -145.84, -77.884, -158.705, -73.681, -101.756, -75.963, -29.06, -12.154, -113.728, -6.956, -44.344, -40.238, -58.715, -23.74, -15.021, 13.595, 7.73, -8.859, -12.01, 25.685, 1177.953, 5958.462, 3152.121],
        '255': [-1909.403, -760.637, 22.782, 599.8, 26005.418, 68041.903, 66.866, -28.337, -28.976, -121.05, -21.364, 37.226, -60.294, -32.26, -41.385, -21.706, 24.532, 12.17, -30.412, -8.393, -34.331, -25.669, -19.898, -25.484, -10.722, -1.855, 14.166, 22.765, 30.574, 1238.276],
        '265': [-487.202, -607.176, -210.014, 75.052, 321.182, 27504.42, 48705.593, 39.522, 42.078, 10.259, -30.051, -10.104, -25.793, -13.189, -11.578, -8.907, -21.67, -11.82, -0.511, -2.351, -2.683, -11.683, -7.566, 5.04, 1.841, -11.308, -0.584, -4.094, 34.751, 9.438],
        '275': [-338.619, -103.286, -113.088, 27.048, 242.139, 425.958, 27501.684, 37269.778, 16.446, 19.51, -19.947, -1.454, -22.934, -4.773, -4.991, -2.354, -0.711, -9.579, -10.295, -6.326, -3.288, -0.239, -3.995, -2.182, -2.113, -0.639, 4.029, 2.661, 4.64, 14.144],
        '285': [-298.74, -168.631, 111.766, 26.327, 77.879, 595.227, 534.468, 22156.409, 28021.955, 22.274, 0.318, -0.558, -4.139, 0.697, -7.447, 2.869, -2.274, 0.039, -2.269, -5.526, -7.151, -1.106, -0.53, 0.813, -0.773, 1.227, 0.656, -1.576, -0.401, 5.219],
        '295': [-85.633, -112.079, 41.923, 51.965, 75.951, 240.874, 783.559, 438.321, 17685.279, 21085.316, 14.809, 4.388, 3.586, -1.216, -2.242, 0.871, 0.031, -3.691, 0.029, -3.018, -6.17, -2.764, -1.206, -3.441, 1.503, 1.013, 4.364, 0.268, 2.607, 5.221],
        '305': [-50.397, -55.706, 68.46, 92.912, 83.205, 241.414, 472.489, 894.919, 389.216, 16449.402, 15474.516, 16.219, -0.892, 3.436, -3.89, 6.015, 0.025, -2.224, -0.981, -2.816, -0.044, 0.92, -2.764, 1.181, -0.338, -0.511, 2.726, 2.25, 4.187, 5.53],
        '315': [-166.515, -65.92, 26.937, 91.951, 123.044, 240.594, 382.084, 581.516, 679.28, 284.646, 12245.196, 13106.626, 8.729, -0.66, 5.314, 1.445, 3.221, -1.586, -1.841, -2.907, 0.551, -0.285, -0.477, -0.814, 1.696, 0.729, 2.813, 2.585, 2.585, 4.462],
        '325': [-113.915, -76.16, 36.629, 88.033, 93.589, 198.463, 351.742, 506.25, 464.699, 448.315, 221.218, 8969.9, 10365.345, 1.883, 4.246, 2.357, 2.196, -2.245, 0.628, -1.727, 0.938, -0.073, -1.35, -1.936, -1.045, 1.181, 4.668, 2.12, 4.42, 6.582],
        '335': [-78.39, -54.491, 42.843, 100.672, 90.883, 153.107, 298.249, 420.094, 446.335, 472.152, 260.473, 136.734, 7602.492, 8216.602, 4.329, 4.185, 1.332, -0.861, 1.603, -0.031, -0.647, -0.873, -0.33, -0.415, 0.367, 2.708, 3.328, 4.79, 4.841, 5.659],
        '345': [-79.392, -83.058, 21.186, 103.463, 82.527, 155.567, 228.565, 365.93, 432.168, 371.119, 404.001, 141.75, 117.324, 6796.424, 7045.183, 6.039, 1.355, 0.485, -0.076, 0.824, 0.275, 0.818, 0.427, -1.71, 0.157, 1.408, 3.678, 6.725, 6.109, 6.428],
        '355': [-142.757, -50.711, 20.233, 108.479, 95.384, 135.073, 216.948, 335.661, 400.168, 368.958, 244.801, 295.089, 82.109, 95.102, 4970.149, 5989.359, 1.578, 0.483, 1.0, -0.247, 1.418, 0.33, 0.701, -0.847, -1.284, 1.862, 3.352, 5.373, 5.4, 5.88],
        '365': [-69.294, -46.965, 10.503, 80.369, 85.721, 139.112, 196.853, 284.262, 325.81, 334.629, 249.478, 159.518, 237.92, 73.866, 71.783, 4444.471, 4853.358, 3.802, 0.391, -0.398, -0.56, -0.079, -1.064, 0.145, -0.513, 1.036, 2.496, 4.558, 6.093, 6.275],
        '375': [-62.791, -45.401, 24.912, 68.204, 77.588, 134.456, 194.808, 243.67, 280.243, 303.688, 246.687, 192.607, 148.352, 168.167, 52.077, 67.19, 3961.692, 4106.883, 2.711, 0.612, 0.721, -1.071, 0.525, -0.247, -0.225, 2.178, 2.282, 3.093, 2.968, 5.354],
        '385': [-119.43, -21.806, 16.746, 68.065, 83.298, 134.895, 200.711, 233.203, 286.229, 305.464, 271.148, 208.551, 146.57, 151.029, 110.133, 56.618, 61.05, 3367.149, 3322.563, 2.546, -0.137, 0.09, 0.169, -1.503, -0.818, 0.267, 2.321, 3.504, 3.539, 5.783],
        '395': [-44.035, -31.412, 14.546, 57.354, 75.578, 140.705, 212.397, 258.103, 305.788, 340.792, 308.085, 247.564, 158.084, 137.236, 143.118, 78.697, 43.35, 50.149, 3121.031, 2912.397, 1.545, -0.335, 0.518, 1.439, 0.056, 0.465, 0.738, 4.099, 5.783, 6.404],
        '405': [-103.169, -46.203, 8.931, 69.609, 97.75, 184.592, 236.547, 272.498, 340.311, 388.554, 372.947, 290.193, 184.414, 142.932, 113.196, 161.768, 58.324, 42.974, 50.503, 2531.653, 3027.34, 0.722, 1.101, -0.333, 0.343, 1.323, 2.243, 2.331, 6.294, 6.58],
        '415': [-66.61, -40.048, 33.741, 63.65, 89.408, 206.487, 262.985, 284.707, 383.316, 454.176, 421.081, 316.532, 193.781, 129.575, 111.479, 100.446, 133.628, 53.066, 36.881, 40.293, 2019.1, 2221.72, 2.744, 0.879, -0.325, 0.78, 1.895, 3.719, 3.759, 5.972],
        '425': [-98.708, -62.352, 18.092, 91.122, 108.574, 218.583, 279.221, 315.21, 425.772, 483.913, 483.191, 359.525, 195.523, 134.053, 109.653, 99.029, 86.251, 97.64, 41.697, 33.342, 38.998, 1429.425, 1887.783, 3.516, 1.002, 1.127, 1.412, 3.727, 4.514, 7.013],
        '435': [-83.324, -18.637, 20.025, 106.641, 142.411, 254.171, 329.109, 359.958, 485.91, 592.909, 545.593, 407.623, 230.363, 161.453, 133.461, 108.866, 96.017, 104.06, 83.195, 64.467, 60.605, 63.63, 1448.163, 1544.518, 5.449, 2.632, 3.44, 5.976, 8.205, 9.7],
        '445': [-33.774, -36.436, 54.57, 214.41, 293.341, 416.115, 466.203, 471.131, 618.903, 762.84, 720.513, 546.954, 341.798, 265.291, 189.406, 141.544, 149.1, 163.021, 197.549, 181.693, 174.981, 159.803, 139.763, 1398.124, 1288.678, 9.867, 7.015, 14.378, 19.029, 19.85],
        '455': [-105.011, -21.055, 213.334, 476.868, 632.841, 796.31, 841.241, 707.083, 921.929, 1116.301, 1106.538, 883.646, 640.101, 505.611, 362.362, 218.146, 270.174, 332.716, 391.658, 434.494, 448.175, 420.461, 334.986, 207.909, 1187.496, 1495.366, 24.393, 27.001, 39.012, 45.61],
        '465': [-90.659, -9.267, 766.358, 955.086, 1115.267, 1347.156, 1336.962, 1082.893, 1365.442, 1671.3, 1606.933, 1308.842, 1054.421, 834.596, 589.829, 347.013, 420.852, 582.155, 685.522, 781.025, 873.937, 821.946, 672.84, 436.146, 244.45, 1168.214, 1285.506, 71.655, 71.445, 74.297],
        '475': [-79.615, -40.044, 451.081, 3388.047, 1630.388, 1924.442, 1927.973, 1489.303, 1804.82, 2202.314, 2138.266, 1752.804, 1446.482, 1161.422, 830.939, 462.641, 600.733, 846.087, 1028.488, 1190.2, 1367.942, 1340.914, 1174.783, 855.233, 549.754, 375.878, 1040.954, 1306.548, 112.665, 111.481],
        '485': [-82.244, -36.619, 441.733, 3492.885, 2026.535, 2279.985, 2334.953, 1859.1, 2240.566, 2606.527, 2432.288, 2032.861, 1689.424, 1366.045, 965.338, 559.118, 731.339, 1058.584, 1323.584, 1541.948, 1846.039, 1870.115, 1730.319, 1365.686, 999.028, 698.12, 446.917, 1011.292, 1304.32, 141.278],
        '495': [-75.181, -9.035, 509.7, 1811.033, 4990.769, 2442.624, 2442.582, 1974.891, 2402.882, 2690.281, 2519.431, 2086.157, 1743.657, 1393.483, 971.726, 580.772, 781.073, 1138.363, 1440.232, 1692.744, 2001.034, 2104.232, 2046.79, 1671.385, 1259.117, 904.532, 569.381, 298.749, 980.843, 1265.047],
        '505': [-28.079, 15.764, 462.698, 1623.982, 4099.774, 2439.169, 2438.091, 1984.585, 2313.2, 2584.831, 2414.782, 1948.872, 1651.392, 1327.096, 949.291, 585.131, 747.347, 1118.494, 1399.564, 1665.897, 1991.171, 2087.629, 2049.141, 1760.077, 1335.472, 954.707, 614.792, 306.168, 209.064, 1135.562],
        '515': [-38.609, -8.15, 409.275, 1504.59, 1938.0, 6696.088, 2248.922, 1800.796, 2148.495, 2421.527, 2176.366, 1805.271, 1491.648, 1213.669, 866.556, 536.833, 704.298, 1031.231, 1298.052, 1557.049, 1885.043, 2011.157, 1961.53, 1710.973, 1345.107, 983.494, 633.618, 328.333, 209.956, 171.839],
        '525': [-76.47, -17.214, 372.14, 1367.901, 1561.683, 5541.777, 2066.034, 1674.643, 1995.288, 2107.188, 1922.982, 1559.317, 1317.033, 1078.943, 768.75, 486.688, 638.732, 928.94, 1173.15, 1412.288, 1713.308, 1856.863, 1846.167, 1651.424, 1300.857, 963.421, 626.183, 318.84, 206.076, 166.208],
        '535': [-80.808, -9.686, 323.074, 1111.645, 1370.169, 1846.961, 7529.951, 1467.202, 1732.183, 1828.991, 1633.323, 1314.966, 1138.111, 895.442, 643.86, 416.75, 556.88, 790.652, 1005.313, 1225.147, 1491.424, 1643.297, 1665.035, 1478.654, 1202.12, 901.771, 572.417, 287.618, 187.851, 151.354],
        '545': [-47.259, -46.4, 275.957, 916.948, 1116.125, 1354.009, 6320.065, 1425.013, 1491.406, 1558.515, 1368.959, 1108.534, 954.502, 760.735, 542.632, 366.999, 477.17, 678.543, 873.906, 1008.885, 1278.363, 1372.859, 1402.881, 1281.749, 1053.224, 765.702, 520.367, 254.386, 173.192, 147.39],
        '555': [-86.002, -41.033, 239.902, 749.346, 906.002, 1144.3, 1517.946, 7999.302, 1254.545, 1283.904, 1118.181, 891.562, 748.642, 603.357, 460.538, 314.087, 417.66, 590.838, 746.165, 867.108, 1052.739, 1164.183, 1173.928, 1062.807, 897.757, 656.011, 442.842, 227.036, 159.658, 127.22],
        '565': [-118.727, -34.816, 174.088, 648.36, 773.574, 1007.389, 1027.175, 6296.331, 1204.776, 1054.244, 938.77, 746.533, 624.87, 505.099, 393.84, 267.849, 354.338, 495.278, 611.106, 705.757, 896.853, 968.01, 977.52, 904.652, 760.933, 561.632, 385.313, 207.365, 148.101, 126.038],
        '575': [-122.241, -68.426, 127.467, 491.063, 597.22, 795.035, 849.605, 1078.307, 7659.795, 879.27, 755.072, 591.28, 538.555, 423.001, 311.942, 225.102, 301.491, 417.109, 495.196, 596.358, 720.074, 784.34, 800.833, 750.376, 634.587, 473.58, 334.83, 179.096, 133.385, 117.472],
        '585': [-53.212, -55.325, 106.587, 388.278, 473.651, 602.922, 795.31, 698.944, 5716.378, 826.787, 652.604, 490.517, 407.467, 332.43, 266.105, 190.54, 249.309, 325.476, 416.894, 480.97, 591.761, 630.816, 650.668, 618.772, 526.024, 390.769, 270.09, 142.452, 112.234, 105.835],
        '595': [-64.971, -73.675, 94.41, 299.262, 385.765, 492.44, 635.503, 588.218, 909.497, 6333.618, 498.453, 388.011, 321.611, 273.437, 218.84, 167.256, 204.179, 279.176, 333.347, 389.488, 462.306, 510.296, 532.849, 491.892, 415.199, 321.813, 219.442, 116.223, 104.447, 91.38],
        '605': [-160.693, -28.601, 69.889, 229.116, 297.988, 422.838, 495.764, 566.81, 545.371, 5022.316, 497.773, 320.523, 265.834, 210.74, 173.367, 132.168, 168.428, 224.184, 271.976, 315.871, 370.208, 404.242, 422.756, 400.843, 355.27, 257.358, 184.889, 103.324, 85.106, 82.547],
        '615': [-151.379, -105.201, 18.155, 187.787, 242.412, 317.286, 442.797, 482.57, 453.61, 696.467, 5702.938, 255.856, 228.487, 160.372, 139.306, 113.095, 137.243, 178.596, 206.976, 239.552, 310.747, 322.756, 344.272, 336.869, 278.455, 212.506, 154.467, 86.553, 73.385, 70.498],
        '625': [-278.021, -108.39, 36.482, 172.608, 218.356, 283.232, 356.033, 420.729, 443.903, 376.136, 5040.953, 344.809, 193.424, 165.686, 112.664, 87.354, 111.999, 148.837, 166.271, 210.234, 250.854, 263.926, 285.531, 265.644, 243.414, 177.24, 134.684, 70.877, 67.143, 66.09],
        '635': [-319.103, -68.515, 12.978, 127.08, 163.683, 222.206, 314.674, 357.685, 422.857, 300.755, 500.303, 5337.5, 144.729, 117.936, 96.003, 79.984, 93.096, 123.395, 138.093, 158.321, 184.469, 204.317, 215.59, 209.488, 192.458, 143.38, 100.456, 59.853, 62.964, 58.695],
        '645': [-216.159, -120.382, -12.42, 103.564, 122.007, 195.194, 244.229, 308.635, 300.24, 235.763, 213.191, 4051.533, 203.153, 92.272, 76.714, 61.623, 72.943, 96.253, 113.983, 120.036, 151.389, 167.697, 172.692, 166.249, 150.706, 110.206, 78.628, 47.859, 40.145, 42.845],
        '655': [-297.679, -50.361, -13.696, 88.729, 87.04, 151.359, 208.936, 264.599, 258.431, 281.335, 160.978, 341.704, 4374.881, 68.638, 60.023, 54.744, 63.369, 69.813, 88.323, 83.991, 118.985, 124.507, 126.07, 127.769, 116.783, 82.672, 66.099, 36.627, 32.157, 33.243],
        '665': [-237.2, -116.865, -30.429, 35.317, 85.677, 96.258, 179.207, 218.297, 230.273, 240.979, 149.361, 120.23, 3581.199, 163.668, 49.006, 38.985, 49.808, 57.158, 67.677, 78.213, 83.875, 96.921, 103.676, 98.846, 90.88, 73.078, 50.785, 32.14, 31.113, 31.028],
        '675': [-230.44, -110.687, -21.985, 51.438, 63.457, 101.618, 132.715, 200.488, 220.793, 202.929, 170.948, 81.087, 298.543, 3940.753, 29.161, 38.809, 36.526, 51.969, 52.442, 56.888, 65.489, 79.26, 81.892, 77.632, 73.406, 58.916, 40.682, 25.751, 28.803, 22.876],
        '685': [-340.979, -169.034, 46.444, 56.5, 66.637, 89.653, 132.667, 166.159, 203.278, 213.932, 183.81, 82.986, 74.255, 3462.346, 213.914, 30.943, 33.59, 30.704, 41.15, 48.458, 55.076, 61.373, 58.61, 56.781, 59.123, 45.363, 35.256, 17.513, 19.318, 18.883],
        '695': [-313.337, -193.869, 119.181, 28.163, 63.787, 59.633, 123.996, 175.057, 212.502, 182.622, 128.739, 103.321, 56.464, 270.476, 4950.677, 13.262, 26.122, 24.893, 35.714, 34.877, 39.086, 45.821, 36.391, 43.21, 45.667, 40.526, 34.107, 18.511, 10.327, 8.955],
        '705': [-371.215, -173.671, 142.551, 320.972, 37.804, 84.077, 111.843, 177.846, 242.036, 207.158, 132.962, 128.006, 69.296, 50.134, 3207.402, 227.37, 11.327, 15.899, 12.681, 23.988, 28.738, 40.194, 35.492, 44.137, 33.261, 25.189, 62.234, 14.543, 13.457, 12.621],
        '715': [-501.396, -128.631, -93.645, 1272.674, 43.534, 31.94, 96.339, 144.593, 157.5, 191.477, 163.46, 103.763, 54.244, 48.301, 200.06, 4274.892, 15.559, 21.224, 16.286, 21.139, 26.368, 29.186, 14.728, 37.054, 23.075, 18.365, 16.244, 90.316, 8.739, 8.517],
        '725': [-595.148, -204.491, -61.083, 1076.336, 52.642, 48.539, 84.381, 108.655, 203.634, 151.518, 125.452, 87.737, 81.439, 42.778, 35.197, 3350.16, 225.619, 8.46, 19.535, 17.653, 7.318, 12.418, 30.374, 27.892, 16.437, 14.908, 14.704, 65.586, 33.905, 11.576],
        '735': [-759.416, -453.838, -162.65, 308.616, 654.287, 70.587, 88.481, 141.553, 117.0, 149.4, 129.129, 89.025, 130.442, 61.501, 45.558, 182.93, 4379.232, 9.271, 9.417, -0.383, 8.036, 12.398, 13.916, 12.321, 7.777, 14.695, 7.577, 8.635, 168.132, 5.159],
        '745': [-507.663, -245.141, -64.887, -41.55, 2147.908, 21.003, 79.256, 74.806, 204.281, 194.1, 125.659, 129.036, 94.888, 43.509, 36.029, 37.798, 3337.583, 345.408, 3.326, 10.114, 8.855, 6.694, 11.036, 5.955, 10.423, 5.695, 11.291, 4.694, 20.954, 0.179]}

z_data = pd.DataFrame(prep_data)

x, y = np.linspace(215, 745, num=54), np.linspace(210, 500, num=30)

fig = go.Figure(data=[go.Surface(z=z_data.values, x=x, y=y)])

fig.update_traces(contours_z=dict(show=True, usecolormap=True,
                                  highlightcolor="limegreen", project_z=True))
fig.update_layout(title='3D Spectrum Graph Report', autosize=False,
                  scene_camera_eye=dict(x=1.87, y=0.88, z=0),
                  width=745, height=600)


fig.show()
